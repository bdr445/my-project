/* General Styling */
:root {
    --primary-color: #0078d4;
    /* اللون الأساسي للتطبيق */
    --background-color: #f4f4f4;
    --background-image: url('images/background.jpg');
    /* الخلفية الافتراضية */
    --card-background: #ffffff;
    --text-color: #333333;
    --border-color: #dddddd;
    --shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    --priority-normal: #28a745;
    --priority-important: #ffc107;
    --priority-urgent: #dc3545;
}

/* Accessibility helper class */
.visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    border: 0;
}

body {
    font-family: 'Tajawal', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    background-color: var(--background-color);
    color: var(--text-color);
    line-height: 1.6;
}

/* App Layout */
.app-layout {
    display: flex;
    transition: margin-right 0.3s ease;
    height: 100vh;
}

.lang-rtl .app-layout {
    flex-direction: row-reverse;
}

.lang-ltr .app-layout {
    flex-direction: row;
}

main {
    transition: all 0.3s ease;
    flex: 1;
    padding: 20px 40px;
    overflow-y: auto;
    /* --- Background Image (Re-added) --- */
    background-image: var(--background-image);
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
}

/* Page Blocker to prevent Flash of Unstyled/Old-Styled Content (FOUC) */
#page-blocker {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--background-color);
    /* Use a neutral background */
    z-index: 9999;
    opacity: 1;
    transition: opacity 0.2s ease-out;
}


.home-link {
    color: var(--primary-color);
    text-decoration: none;
}

.home-link:hover {
    text-decoration: underline;
}

header p {
    margin: 0;
    color: #666;
}

/* Sidebar */
#sidebar {
    width: 220px;
    background-color: var(--card-background);
    padding: 15px;
    border-left: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    transition: width 0.3s ease, padding 0.3s ease, transform 0.3s ease;
    flex-shrink: 0;
    z-index: 1000;
    position: relative;
}

.sidebar-footer {
    margin-top: auto;
    /* Pushes this nav to the bottom */
}

.account-menu-container {
    position: relative;
}

.account-menu {
    position: absolute;
    bottom: 100%;
    /* Position above the button */
    right: 0;
    width: 100%;
    background-color: var(--card-background);
    border-radius: 6px;
    box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
    border: 1px solid var(--border-color);
    z-index: 10;
    overflow: hidden;
    margin-bottom: 10px;
    /* Space between menu and button */
}

.account-menu.hidden {
    display: none;
}

.account-menu a {
    padding: 12px 15px;
    display: block;
    color: var(--text-color);
    text-decoration: none;
}

.account-menu a:hover {
    background-color: #f0f0f0;
}


#sidebar header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.sidebar-header-content {
    opacity: 1;
    transition: opacity 0.2s ease, visibility 0.2s ease;
    white-space: nowrap;
    overflow: hidden;
}

#sidebar-toggle-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
}

#sidebar-toggle-btn:hover {
    background-color: #f0f0f0;
}

#sidebar-toggle-btn svg {
    width: 24px;
    height: 24px;
}

#sidebar h1 {
    font-size: 1.3em;
    color: var(--primary-color);
    margin: 0;
    font-weight: 700;
}

#sidebar h2 {
    font-size: 0.85em;
    text-transform: uppercase;
    color: #999;
    margin: 15px 0 8px;
    letter-spacing: 0.5px;
    font-weight: 600;
}

#sidebar nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#sidebar nav a {
    padding: 8px 12px;
    text-decoration: none;
    color: var(--text-color);
    border-radius: 6px;
    font-weight: 500;
    transition: background-color 0.2s;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.95em;
}

#sidebar nav a:hover {
    background-color: #f0f0f0;
}

#sidebar nav a.active {
    background-color: var(--primary-color);
    color: white;
}

/* Sidebar icon styling */
.sidebar-icon {
    width: 22px;
    height: 22px;
    vertical-align: middle;
    flex-shrink: 0;
    transition: margin 0.3s ease;
}

.link-text {
    white-space: nowrap;
    transition: opacity 0.2s ease;
}


/* Task Count in Sidebar */
.task-count {
    font-size: 0.8em;
    margin-left: 5px;
    /* Space after the category name */
}

/* Main Content */

/* Alerts Container Styling */
#alerts-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 20px;
}

/* --- Collapsed Sidebar Styles --- */
#sidebar.sidebar-collapsed {
    width: 50px;
    /* Width of icons + padding */
    padding: 20px 15px;
    align-items: center;
}

.lang-ltr #sidebar {
    border-left: none;
    border-right: 1px solid var(--border-color);
}

.lang-rtl #sidebar {
    border-right: none;
    border-left: 1px solid var(--border-color);
    order: 2;
}

.lang-ltr #sidebar.sidebar-collapsed {
    align-items: flex-start;
}

.lang-rtl #sidebar.sidebar-collapsed {
    align-items: flex-end;
}

#sidebar.sidebar-collapsed .sidebar-header-content {
    opacity: 0;
    visibility: hidden;
    width: 0;
}

#sidebar.sidebar-collapsed .link-text {
    opacity: 0;
    width: 0;
    visibility: hidden;
}

#sidebar.sidebar-collapsed nav a {
    justify-content: center;
}

#sidebar.sidebar-collapsed h2 {
    /* Optional: hide category titles when collapsed */
    display: none;
}

#sidebar.sidebar-collapsed .account-menu {
    right: -200px;
    /* Move menu out of the way */
}

.alert {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 15px;
    border-radius: 6px;
    color: white;
    font-weight: 500;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
}

.alert-icon {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

.alert.alert-due-soon {
    background-color: rgba(255, 193, 7, 0.6);
    /* Orange, semi-transparent */
    border-color: rgba(255, 193, 7, 0.8);
}

.alert.alert-overdue {
    background-color: rgba(220, 53, 69, 0.6);
    /* Red, semi-transparent */
    border-color: rgba(220, 53, 69, 0.8);
}

.toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 20px;
}

.user-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
}

.user-avatar {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.35);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    text-transform: uppercase;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
    background-size: cover;
    background-position: center;
}

.user-greeting {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.user-greeting-text {
    font-weight: 700;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.user-greeting-sub {
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9em;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
}

.search-container {
    flex-grow: 1;
    min-width: 0;
    /* Allows flex item to shrink below content size */
}

#search-input {
    width: 100%;
    padding: 8px 15px;
    border: 1px solid var(--border-color);
    border-radius: 20px;
    box-sizing: border-box;
    transition: border-color 0.2s, box-shadow 0.2s;
    max-width: 100%;
    /* Prevents overflow */
}

#search-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
}

.sort-options span {
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.sort-btn {
    background: none;
    border: 1px solid var(--border-color);
    padding: 5px 15px;
    margin-right: 5px;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.2s;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.sort-btn:hover,
.sort-btn.active {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.view-options {
    display: flex;
    border: 1px solid var(--border-color);
    border-radius: 20px;
    overflow: hidden;
}

.view-btn {
    background: none;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.2s;
    line-height: 1;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 44px;
    /* Ensures consistent button size */
    height: 36px;
    /* Fixed height for consistency */
}

.view-btn svg {
    width: 20px;
    height: 20px;
    display: block;
    flex-shrink: 0;
}

.view-btn:not(:first-child) {
    border-right: 1px solid var(--border-color);
}

.view-btn.active {
    background-color: var(--primary-color);
    color: white;
}

/* Floating Action Button */
.fab {
    position: fixed;
    bottom: 30px;
    left: 30px;
    right: auto;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: var(--primary-color);
    border: none;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.3s ease-out;
}

.fab svg {
    width: 30px;
    height: 30px;
    color: white;
}

.fab:hover {
    transform: scale(1.1) rotate(90deg);
}

.lang-ltr .fab {
    left: auto;
    right: 30px;
}

.lang-rtl .fab {
    left: 30px;
    right: auto;
}

/* Modal Styling */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    /* Animation properties */
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.modal-overlay.hidden {
    opacity: 0;
    visibility: hidden;
}

.modal-content {
    background: white;
    padding: 30px;
    border-radius: 8px;
    width: 90%;
    max-width: 500px;
    position: relative;
    /* Animation properties */
    transform: translateY(0);
    opacity: 1;
    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.3s ease;
}

.modal-overlay.hidden .modal-content {
    transform: translateY(50px);
    opacity: 0;
}

.modal-content.confirm-modal {
    max-width: 400px;
    text-align: center;
}

.modal-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
}

.btn.btn-danger {
    background-color: var(--priority-urgent);
}

.btn.btn-secondary {
    background-color: #6c757d;
}

.close-modal-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    background: none;
    border: none;
    cursor: pointer;
    color: #999;
    padding: 0;
    width: 24px;
    height: 24px;
}

.close-modal-btn svg {
    width: 100%;
    height: 100%;
}

#task-form input,
#task-form textarea,
#task-form select {
    width: 100%;
    padding: 12px;
    margin-bottom: 15px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    box-sizing: border-box;
}

/* إصلاح اتجاه الكتابة في حقول التاريخ والوقت */
#task-form input[type="date"],
#task-form input[type="time"] {
    direction: ltr;
    text-align: right;
}

.btn {
    display: block;
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 4px;
    background-color: var(--primary-color);
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.btn:hover {
    background-color: #005a9e;
}

/* New Button Variants */
.btn-secondary {
    background-color: #6c757d;
}

.btn-secondary:hover {
    background-color: #5a6268;
}

.btn-danger-soft {
    background-color: rgba(220, 53, 69, 0.15);
    color: #dc3545;
    border: 2px solid rgba(220, 53, 69, 0.3);
    margin-top: 15px;
    width: auto;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 10px 28px;
    border-radius: 50px;
    font-weight: 700;
    font-size: 0.95em;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 4px 10px rgba(220, 53, 69, 0.1);
}

.btn-danger-soft:hover {
    background-color: #dc3545 !important;
    color: white !important;
    border-color: #dc3545 !important;
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 20px rgba(220, 53, 69, 0.4);
}

.btn-danger-soft:active {
    transform: translateY(-1px) scale(0.98);
    box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
}

.trash-controls {
    text-align: center;
    margin-bottom: 25px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(5px);
    border-radius: 12px;
    /* Removed border as requested */
}

.deleted-info-message {
    color: #666;
    font-size: 0.95em;
    margin-bottom: 12px;
    font-weight: 500;
}

/* Tag Styles */
.tag-input-group {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.tag-chip {
    display: inline-flex;
    align-items: center;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.85em;
    margin: 2px;
    color: white;
    /* Default text color */
}

.tag-color-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
    margin-left: 8px;
    /* RTL spacing */
}

/* Update sidebar link alignment for tags */
#sidebar nav a {
    display: flex;
    align-items: center;
}

.tag-hint {
    font-size: 0.85em;
    color: #856404;
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    padding: 8px 12px;
    border-radius: 6px;
    margin-bottom: 15px;
    margin-top: -10px;
    display: block;
    animation: fadeIn 0.3s ease-in-out;
}

.tag-hint.hidden {
    display: none;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-5px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}



.btn:hover {
    background-color: #005a9e;
}

#task-form h2 {
    margin-top: 0;
}

/* Task List Styling */
#tasks-list {
    display: grid;
    gap: 15px;
}

/* Grid View Specific Styles */
#tasks-list.grid-view {
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    align-items: start;
}

.task-card {
    /* جعل البطاقة شبه شفافة لإظهار الخلفية */
    background-color: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(8px);
    /* تأثير ضبابي للخلفية خلف البطاقة */
    -webkit-backdrop-filter: blur(8px);
    /* لدعم متصفح سفاري */
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
    /* border-right: 5px solid var(--priority-normal); */
    /* Removed old border */
    border: 1px solid rgba(255, 255, 255, 0.2);
    /* حد شفاف خفيف */
    display: flex;
    flex-direction: column;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.3s ease;
}

/* Animation for filtering */
.task-card.is-filtering-out {
    animation: fadeOutDown 0.3s ease-out forwards;
}

.task-card.is-filtering-in {
    animation: fadeInUp 0.4s ease-out forwards;
}

@keyframes fadeOutDown {
    from {
        opacity: 1;
        transform: translateY(0);
    }

    to {
        opacity: 0;
        transform: translateY(20px);
    }
}


/* Apply animation only to newly added tasks */
.task-card.newly-added {
    animation: fadeInUp 0.4s ease-out forwards;
}

/* Add a subtle lift effect on hover for non-deleted tasks */
.task-card:not(.deleted-task):hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.12);
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.task-card.completed {
    opacity: 0.7;
    /* تعديل شفافية البطاقة المكتملة أيضاً */
    background-color: rgba(249, 249, 249, 0.7);
}

.task-card.completed h3 {
    color: #888;
}

/* The line that will be animated for the line-through effect */
.task-card h3::after {
    content: '';
    position: absolute;
    top: 50%;
    right: 0;
    width: 100%;
    height: 2px;
    background: #888;
    transform: scaleX(0);
    transform-origin: right;
    transition: transform 0.35s cubic-bezier(0.65, 0, 0.35, 1);
}

/* When the task is completed, draw the line */
.task-card.completed h3::after {
    transform: scaleX(1);
}

.deleted-info-message {
    text-align: center;
    padding: 10px;
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    color: #6c757d;
    margin-bottom: 15px;
}

.empty-state-message {
    color: white;
    text-align: center;
    font-size: 1.1em;
    padding: 20px;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6);
    background-color: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    backdrop-filter: blur(4px);
}

.task-card h3 {
    margin: 0;
    font-size: 1.1em;
    position: relative;
    /* Needed for the ::after pseudo-element */
}

.task-card p {
    margin: 0;
    color: #555;
    white-space: pre-wrap;
    /* Preserves line breaks */
}

.task-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9em;
    color: #777;
    margin-top: 15px;
}

.due-date-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 4px 10px;
    border-radius: 15px;
    background-color: rgba(0, 0, 0, 0.05);
    border: 1px solid rgba(0, 0, 0, 0.1);
    font-size: 0.85em;
}

.due-date-badge.due-soon {
    background-color: rgba(255, 193, 7, 0.2);
}

.due-date-badge.overdue {
    background-color: rgba(220, 53, 69, 0.2);
    color: var(--priority-urgent);
    font-weight: bold;
}

.meta-icon {
    width: 16px;
    height: 16px;
}

.task-meta .delete-timer {
    display: block;
    margin-top: 8px;
    font-size: 0.85em;
    color: var(--priority-urgent);
    background-color: rgba(220, 53, 69, 0.1);
    padding: 3px 8px;
    border-radius: 4px;
}

.task-actions {
    display: flex;
    gap: 10px;
    align-items: center;
}

/* New styles for the card header and priority dot */
.task-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
}

.task-title-container {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-grow: 1;
    /* Allow title to take available space */
}

.priority-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
    /* Prevent dot from shrinking */
    background-color: var(--priority-normal);
    /* Default color */
}

.task-card.important .priority-dot {
    background-color: var(--priority-important);
}

.task-card.urgent .priority-dot {
    background-color: var(--priority-urgent);
}

/* Adjust action buttons for the new layout */
.task-actions .action-btn {
    padding: 0;
    font-size: 1.1em;
    color: #888;
}

.task-actions .action-btn:hover {
    color: var(--text-color);
}

.action-btn svg {
    width: 20px;
    height: 20px;
    display: block;
    /* Helps with alignment */
}

/* New Complete Button Styles */
.complete-btn-circle {
    background-color: transparent;
    border: 2px solid #ccc;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    flex-shrink: 0;
    /* Prevent shrinking */
}

.complete-btn-circle:hover {
    border-color: var(--primary-color);
}

.task-card.completed .complete-btn-circle {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
}

/* The checkmark inside the circle */
.complete-btn-circle::after {
    content: '✓';
    color: white;
    font-size: 16px;
    font-weight: bold;
    transform: scale(0);
    transition: transform 0.2s ease;
}

.task-card.completed .complete-btn-circle::after {
    transform: scale(1);
}

.action-btn {
    background: none;
    border: none;
    cursor: pointer;
    font-weight: bold;
    padding: 5px;
    font-size: 1.2em;
    transition: transform 0.2s;
}

.action-btn:hover {
    transform: scale(1.2);
}

.edit-btn {
    color: var(--primary-color);
}

.restore-btn {
    color: #6c757d;
}

.delete-btn {
    color: var(--priority-urgent);
}

/* Sidebar Overlay for Mobile */
.sidebar-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.sidebar-overlay.active {
    display: block;
    opacity: 1;
}

/* Mobile Menu Button */
.mobile-menu-btn {
    display: none;
    position: fixed;
    top: 15px;
    right: 15px;
    z-index: 1001;
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease;
}

.mobile-menu-btn:hover {
    transform: scale(1.05);
}

.mobile-menu-btn svg {
    width: 24px;
    height: 24px;
    display: block;
}

/* Responsive Design */
@media (max-width: 768px) {
    .app-layout {
        flex-direction: column;
    }

    .mobile-menu-btn {
        display: block;
    }

    #sidebar {
        position: fixed;
        top: 0;
        right: 0;
        width: 280px;
        max-width: 85vw;
        height: 100vh;
        height: 100dvh;
        /* Dynamic viewport height for mobile */
        border-left: 1px solid var(--border-color);
        border-bottom: none;
        transform: translateX(100%);
        overflow-y: auto;
        box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
    }

    #sidebar.sidebar-open {
        transform: translateX(0);
    }

    #sidebar.sidebar-collapsed {
        width: 280px;
        max-width: 85vw;
        padding: 20px;
        transform: translateX(100%);
    }

    #sidebar.sidebar-collapsed.sidebar-open {
        transform: translateX(0);
    }

    #sidebar.sidebar-collapsed .sidebar-header-content,
    #sidebar.sidebar-collapsed .link-text,
    #sidebar.sidebar-collapsed h2 {
        opacity: 1;
        visibility: visible;
        width: auto;
        display: block;
    }

    #sidebar.sidebar-collapsed nav a {
        justify-content: flex-start;
    }

    main {
        padding: 20px;
        width: 100%;
    }

    .fab {
        bottom: 20px;
        left: 20px;
    }

    .toolbar {
        flex-direction: column;
        align-items: stretch;
        gap: 15px;
    }

    .search-container {
        width: 100%;
        order: 1;
        max-width: none;
        /* Ensure it takes full width */
    }

    .sort-options {
        order: 2;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 10px;
    }

    .view-options {
        order: 3;
        align-self: flex-start;
        /* Ensure view options don't break layout */
        flex-shrink: 0;
    }

    /* Small mobile tweaks */
    @media (max-width: 400px) {
        .form-container {
            padding: 20px;
            margin: 10px;
        }

        .welcome-container {
            padding: 30px 20px;
        }

        .welcome-container h1 {
            font-size: 2.2em;
        }

        .task-meta {
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }

        .task-actions {
            margin-top: 10px;
            align-self: flex-end;
        }
    }

    /* Prevent body scroll when sidebar is open */
    body.sidebar-open {
        overflow: hidden;
    }
}

@media (max-width: 480px) {
    #sidebar {
        width: 100%;
        max-width: 100%;
    }

    #sidebar.sidebar-collapsed {
        width: 100%;
        max-width: 100%;
    }
}

/* =================================== */
/*          Homepage Styling           */
/* =================================== */

.home-page {
    background-image: url('images/welcome-bg.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    /* Center the content */
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    height: 100vh;
    padding: 20px;
}

.welcome-container {
    background-color: var(--card-background);
    padding: 40px 50px;
    border-radius: 12px;
    box-shadow: var(--shadow);
    max-width: 600px;
    width: 100%;
}

.welcome-container h1 {
    font-size: 3em;
    color: var(--primary-color);
    margin: 0 0 10px 0;
}

.welcome-container>* {
    animation: fadeInUp 0.8s ease-out both;
}

.welcome-container .tagline {
    font-size: 1.2em;
    color: #555;
    margin-bottom: 25px;
    animation-delay: 0.2s;
}

.welcome-container .description {
    color: var(--text-color);
    margin-bottom: 30px;
    animation-delay: 0.4s;
}

.home-page .btn {
    display: inline-block;
    /* Allow the button to size to its content */
    width: auto;
    /* Reset width from the default .btn style */
    animation-delay: 0.6s;
    background-color: var(--primary-color);
    color: white;
    padding: 15px 40px;
    font-size: 1.2em;
    border-radius: 50px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
}

.home-page .btn:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    /* Override default hover */
}

/* =================================== */
/*           Login Page Styling        */
/* =================================== */

.login-page {
    background-color: var(--background-color);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    /* Add padding to the body */
    height: 100vh;
}

.form-container {
    background-color: var(--card-background);
    padding: 40px;
    border-radius: 8px;
    box-shadow: var(--shadow);
    margin: 20px;
    /* Add margin to the form container */
    width: 100%;
    max-width: 400px;
}

.form-container h1 {
    text-align: center;
    color: var(--primary-color);
    margin-top: 0;
    margin-bottom: 10px;
}

.form-container p {
    text-align: center;
    margin-bottom: 30px;
    color: #666;
}

.form-container .form-group {
    margin-bottom: 20px;
}

.form-container label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.form-container input {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    box-sizing: border-box;
}

.form-container .btn {
    margin-top: 10px;
}

.form-container .hidden {
    display: none;
}

.form-switch {
    font-size: 0.9em;
    margin-top: 20px !important;
}

.error-message {
    background-color: #f8d7da;
    color: #721c24;
    padding: 10px;
    border-radius: 4px;
    text-align: center;
    margin-top: 20px;
}

.success-message {
    background-color: #d4edda;
    color: #155724;
}

.error-message.hidden {
    display: none;
}

.separator {
    display: flex;
    align-items: center;
    text-align: center;
    color: #aaa;
    margin: 20px 0;
}

.separator::before,
.separator::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid var(--border-color);
}

.separator:not(:empty)::before {
    margin-right: .25em;
}

.separator:not(:empty)::after {
    margin-left: .25em;
}

.btn.btn-google {
    background-color: #4285F4;
    color: white;
}

.btn.btn-google:hover {
    background-color: #357ae8;
}

.btn:disabled,
.btn[disabled] {
    background-color: #e9ecef;
    color: #6c757d;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
    opacity: 0.7;
}

.loading-spinner {
    display: inline-block;
    width: 14px;
    height: 14px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin-left: 8px;
    vertical-align: middle;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.btn.btn-google:disabled:hover {
    background-color: #e9ecef;
    /* Prevent hover effect on disabled google button */
}

.guest-link {
    display: block;
    text-align: center;
    margin-top: 25px;
    color: #666;
    text-decoration: none;
}

/* =================================== */
/*          Settings Page Styling      */
/* =================================== */

.settings-page main {
    background: var(--background-color);
    padding: 40px;
}

.settings-container {
    max-width: 800px;
    margin: 0 auto;
    background: var(--card-background);
    padding: 30px;
    border-radius: 8px;
    box-shadow: var(--shadow);
}

@media (max-width: 600px) {
    .settings-page main {
        padding: 15px;
    }

    .settings-container {
        padding: 20px;
    }

    .color-swatches,
    .background-swatches {
        justify-content: center;
    }

}

.language-select-wrapper {
    position: relative;
    display: inline-block;
    width: 220px;
    max-width: 100%;
}

#language-select {
    width: 100%;
    padding: 10px 14px;
    border: 1px solid var(--border-color);
    border-radius: 10px;
    background: linear-gradient(135deg, #ffffff, #f6f7fb);
    color: var(--text-color);
    font-weight: 600;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    transition: border-color 0.2s, box-shadow 0.2s, transform 0.1s;
}

#language-select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.15);
    transform: translateY(-1px);
}

#language-select:active {
    transform: translateY(0);
}

.language-select-wrapper::after {
    content: "";
    position: absolute;
    top: 50%;
    right: 12px;
    width: 10px;
    height: 10px;
    border-right: 2px solid #666;
    border-bottom: 2px solid #666;
    transform: translateY(-50%) rotate(45deg);
    pointer-events: none;
}

.settings-container h1 {
    color: var(--primary-color);
    margin-top: 0;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
    margin-bottom: 25px;
}

.setting-group {
    margin-bottom: 30px;
}

.setting-group h2 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.2em;
}

.color-swatches,
.background-swatches {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.swatch {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    border: 3px solid transparent;
    transition: transform 0.2s, border-color 0.2s;
}

.swatch.active {
    border-color: var(--primary-color);
    transform: scale(1.1);
}

.bg-swatch {
    background-size: cover;
    background-position: center;
    border-radius: 8px;
    width: 100px;
    height: 60px;
}

/* Tags Styling */
.tag-chip {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    background-color: #e0e0e0;
    color: #333;
    font-size: 0.8em;
    margin-left: 5px;
    margin-bottom: 5px;
    font-weight: 500;
}

.task-tags {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

/* Sidebar Tags */
#tags-filters li a {
    display: flex;
    align-items: center;
    font-size: 0.9em;
}

.tag-color-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    margin-left: 8px;
    background-color: var(--primary-color);
}

/* Subtasks Styling */
.subtasks-container {
    margin-top: 12px;
    border-top: 1px solid rgba(0, 0, 0, 0.08);
    padding-top: 10px;
}

.subtask-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.95em;
    margin-bottom: 6px;
    padding: 4px 0;
}

.subtask-item.completed span {
    text-decoration: line-through;
    color: #999;
}

.subtask-checkbox {
    cursor: pointer;
    width: 18px;
    height: 18px;
    accent-color: var(--primary-color);
}

/* Modal Subtasks Input */
.subtasks-input-container {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

#subtasks-list-preview {
    list-style: none;
    padding: 0;
    margin-bottom: 15px;
    max-height: 150px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    border-radius: 6px;
}

#subtasks-list-preview li {
    background: #f9f9f9;
    padding: 8px 12px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#subtasks-list-preview li:last-child {
    border-bottom: none;
}

.remove-subtask-btn {
    background: none;
    border: none;
    color: #dc3545;
    cursor: pointer;
    font-size: 1.4em;
    padding: 0 5px;
    line-height: 1;
}

.remove-subtask-btn:hover {
    color: #bd2130;
}

/* Progress Bar for Subtasks */
.subtask-progress {
    height: 6px;
    background-color: #e9ecef;
    border-radius: 3px;
    margin-bottom: 10px;
    overflow: hidden;
    width: 100%;
}

.subtask-progress-bar {
    height: 100%;
    background-color: var(--primary-color);
    transition: width 0.3s ease;
}

/* Modal Overflow Fix */
.modal-content {
    max-height: 90vh;
    /* Limit height to 90% of viewport */
    overflow-y: auto;
    /* Enable vertical scrolling */
    display: flex;
    flex-direction: column;
}

.modal-content h2 {
    margin-top: 0;
    flex-shrink: 0;
}



.settings-container h1 {
    color: var(--primary-color);
    margin-top: 0;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
    margin-bottom: 25px;
}

.setting-group {
    margin-bottom: 30px;
}

.setting-group h2 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.2em;
}

.color-swatches,
.background-swatches {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.swatch {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    border: 3px solid transparent;
    transition: transform 0.2s, border-color 0.2s;
}

.swatch.active {
    border-color: var(--primary-color);
    transform: scale(1.1);
}

.bg-swatch {
    background-size: cover;
    background-position: center;
    border-radius: 8px;
    width: 100px;
    height: 60px;
}

/* Tags Styling */
.tag-chip {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    background-color: #e0e0e0;
    color: #333;
    font-size: 0.8em;
    margin-left: 5px;
    margin-bottom: 5px;
    font-weight: 500;
}

.task-tags {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

/* Sidebar Tags */
#tags-filters li a {
    display: flex;
    align-items: center;
    font-size: 0.9em;
}

.tag-color-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    margin-left: 8px;
    background-color: var(--primary-color);
}

/* Subtasks Styling */
.subtasks-container {
    margin-top: 12px;
    border-top: 1px solid rgba(0, 0, 0, 0.08);
    padding-top: 10px;
}

.subtask-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.95em;
    margin-bottom: 6px;
    padding: 4px 0;
}

.subtask-item.completed span {
    text-decoration: line-through;
    color: #999;
}

.subtask-checkbox {
    cursor: pointer;
    width: 18px;
    height: 18px;
    accent-color: var(--primary-color);
}

/* Modal Subtasks Input */
.subtasks-input-container {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

#subtasks-list-preview {
    list-style: none;
    padding: 0;
    margin-bottom: 15px;
    max-height: 150px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    border-radius: 6px;
}

#subtasks-list-preview li {
    background: #f9f9f9;
    padding: 8px 12px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#subtasks-list-preview li:last-child {
    border-bottom: none;
}

.remove-subtask-btn {
    background: none;
    border: none;
    color: #dc3545;
    cursor: pointer;
    font-size: 1.4em;
    padding: 0 5px;
    line-height: 1;
}

.remove-subtask-btn:hover {
    color: #bd2130;
}

/* Progress Bar for Subtasks */
.subtask-progress {
    height: 6px;
    background-color: #e9ecef;
    border-radius: 3px;
    margin-bottom: 10px;
    overflow: hidden;
    width: 100%;
}

.subtask-progress-bar {
    height: 100%;
    background-color: var(--primary-color);
    transition: width 0.3s ease;
}

/* Modal Overflow Fix */
.modal-content {
    max-height: 90vh;
    /* Limit height to 90% of viewport */
    overflow-y: auto;
    /* Enable vertical scrolling */
    display: flex;
    flex-direction: column;
}

.modal-content h2 {
    margin-top: 0;
    flex-shrink: 0;
}

#task-form {
    display: flex;
    flex-direction: column;
    /* Allow form textareas and inputs to scroll with the modal content */
}

/* Ensure buttons at the bottom don't get cut off weirdly, maybe add padding */
#task-form>*:last-child {
    margin-bottom: 0;
}

/* =================================== */
/*        Floating Pomodoro Widget     */
/* =================================== */

/* =================================== */
/*        Floating Buttons Styling     */
/* =================================== */

/* =================================== */
/*        Floating Buttons Styling     */
/* =================================== */

.pomodoro-toggle-btn {
    position: fixed;
    /* Aligned above the FAB (Add Task Btn) */
    bottom: 90px;
    left: 20px;
    /* Left aligned */
    right: auto;
    width: 56px;
    height: 56px;
    background-color: white;
    border-radius: 50%;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border: none;
    cursor: pointer;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    /* Only transition shadow and color, NOT transform for the button itself if it causes issues, but scaling is usually fine. 
       The user asked for the text NOT to rotate. Scale doesn't rotate text, but let's be safe. */
    transition: transform 0.2s, box-shadow 0.2s;
    color: #666;
}

.pomodoro-toggle-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
    color: #333;
}

.pomodoro-toggle-btn svg {
    width: 28px;
    height: 28px;
}

/* Tooltip for the button */
.pomodoro-toggle-btn::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 70px;
    /* Show to the right of the button since button is on left */
    right: auto;
    top: 50%;
    /* Important: We need to counter-act the scale transform of the parent if it affects this, 
       but absolute positioning inside a transformed element moves with it. 
       To prevent the text from 'rotating' (if there was rotation), we just ensure no rotate transform is applied. 
       Scale is fine. The user might mean they don't want the text to move/scale? 
       Actually, `transform` on hover scales the whole button including pseudo-elements. 
       To fix this, we can apply the hover effect to a child element or just accept slight scaling.
       However, the user said "rotate with it". Usually scale doesn't rotate. 
       If the user means the FAB rotation (which happens on some FABs), we should check the FAB styles. */
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 0.9em;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
}

/* Counter-scale the tooltip on hover so it stays same size */
.pomodoro-toggle-btn:hover::after {
    opacity: 1;
    transform: translateY(-50%) scale(0.95);
    /* Inverse of 1.05 roughly */
}

/* FAB Styling Updates to match Left Side */
.fab {
    /* Assuming existing FAB styles need override to be on left */
    /* The user said "above the add task button", implying add task is also on left now?
       "I want the button location also on the left but above the create task button".
       So FAB should be on left too. */
    left: 20px;
    right: auto;
    bottom: 20px;
    /* Ensure FAB doesn't rotate the tooltip. 
       Often FABs have a hover effect that rotates the plus icon. 
       If the tooltip is a pseudo-element of the FAB, it will rotate too.
       Solution: Adding a span inside FAB for the icon and rotating THAT, or un-rotating the tooltip.
       Easier: Don't rotate the FAB container, rotate the SVG inside. */
}

.fab:hover {
    transform: none;
    /* Disable container rotation if any */
}

.fab svg {
    transition: transform 0.3s;
}

.fab:hover svg {
    transform: rotate(90deg);
    /* Rotate only the icon */
}

/* FAB Tooltip */
.fab::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 70px;
    /* Right of the button */
    right: auto;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 0.9em;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
    direction: rtl;
}

.fab:hover::after {
    opacity: 1;
    /* Ensure no unexpected transforms */
    transform: translateY(-50%);

    /* Positioning for FAB and Pomodoro toggle depending on language */
    .lang-ltr .pomodoro-toggle-btn {
        right: 20px;
        left: auto;
    }

    .lang-rtl .pomodoro-toggle-btn {
        left: 20px;
        right: auto;
    }

    .lang-ltr .pomodoro-toggle-btn::after {
        right: 70px;
        left: auto;
    }

    .lang-rtl .pomodoro-toggle-btn::after {
        left: 70px;
        right: auto;
    }

    .lang-ltr .fab {
        left: auto;
        right: 30px;
    }

    .lang-rtl .fab {
        left: 30px;
        right: auto;
    }

    .lang-ltr .fab::after {
        left: auto;
        right: 70px;
    }

    .lang-rtl .fab::after {
        left: 70px;
        right: auto;
    }
}

/* Widget Positioning */
.pomodoro-widget {
    position: fixed;
    top: 100px;
    left: 20px;
    /* Default top-left start */
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    width: 240px;
    z-index: 1001;
    overflow: hidden;
    /* Removing transition for transform to prevent lag during drag */
    transition: opacity 0.2s;
    border: 1px solid rgba(0, 0, 0, 0.08);
}

.pomodoro-widget.hidden {
    opacity: 0;
    pointer-events: none;
    /* Use display none via JS eventually, or just fade out */
    visibility: hidden;
}

/* Rest of Pomodoro Styles ... */
.pomodoro-header {
    position: absolute;
    top: -5px;
    right: 0;
    width: auto;
    height: 35px;
    z-index: 10;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    padding: 8px;
}

.pomodoro-header .drag-handle {
    cursor: move;
    padding: 4px 8px;
    border-radius: 12px;
    background: transparent;
    opacity: 0;
    transition: opacity 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: -4px;
}

.pomodoro-widget.minimized:hover .drag-handle {
    opacity: 1;
}

.pomodoro-widget:not(.minimized) .drag-handle {
    display: none;
}

.pomodoro-header .drag-handle:hover {
    background: transparent;
}

.pomodoro-header .drag-handle svg {
    opacity: 0.6;
}

.pomodoro-body {
    padding: 24px 16px 16px 16px;
    text-align: center;
}

.pomodoro-widget.minimized .pomodoro-body {
    display: none;
}

.pomodoro-minimized {
    padding: 6px 12px;
    text-align: center;
    font-weight: bold;
    font-size: 1.2em;
    color: var(--primary-color);
    cursor: pointer;
    display: none;
    background: white;
}

.pomodoro-widget.minimized .pomodoro-minimized {
    display: block;
}

.timer-display {
    font-size: 2.8em;
    font-weight: 700;
    color: #333;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 5px 0 15px 0;
    letter-spacing: 1px;
}

.timer-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}

.timer-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: none;
    background: var(--primary-color);
    color: white;
    font-size: 1.4em;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
}

.timer-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
}

.timer-btn.reset {
    width: 40px;
    height: 40px;
    background: #f1f3f5;
    color: #495057;
    font-size: 1.1em;
    box-shadow: none;
}

.timer-btn.reset:hover {
    background: #e9ecef;
}

.timer-btn svg {
    display: block;
}

.timer-mode {
    display: flex;
    justify-content: center;
    gap: 6px;
}

.mode-btn {
    border: 1px solid transparent;
    background: #f8f9fa;
    color: #6c757d;
    font-size: 0.75em;
    padding: 4px 8px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
}

.mode-btn.active {
    background: #e9ecef;
    color: #212529;
    font-weight: 600;
    border-color: #dee2e6;
}

.mode-btn:hover:not(.active) {
    background: #e9ecef;

}

.custom-timer-input {
    margin-top: 12px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 8px;
    transition: all 0.3s ease;
    overflow: hidden;
    /* Prevent overflow */
}

.custom-timer-input.hidden {
    display: none;
}

.custom-timer-input input[type="number"] {
    width: 60px;
    padding: 6px 8px;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    text-align: center;
    font-size: 1em;
    font-weight: 600;
    color: #333;
    background: white;
    transition: all 0.2s;
    flex-shrink: 0;
}

.custom-timer-input input[type="number"]:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);
}

.custom-timer-input input[type="number"]::-webkit-inner-spin-button,
.custom-timer-input input[type="number"]::-webkit-outer-spin-button {
    opacity: 1;
    height: 30px;
}

.custom-timer-input .btn {
    white-space: nowrap;
    font-size: 0.8em;
    padding: 6px 8px;
    flex-shrink: 1;
    min-width: 50px;
}

/* Tour Overlay Styles */
.tour-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    /* Dark background */
    z-index: 9998;
    display: flex;
    pointer-events: auto;
    /* Catch all clicks on overlay */
}

.tour-overlay.hidden {
    display: none;
    pointer-events: none;
}

.tour-step {
    position: absolute;
    width: 100%;
    height: 100%;
}

.tour-step.hidden {
    display: none;
}

.tour-tooltip {
    position: absolute;
    background: white;
    padding: 20px;
    border-radius: 8px;
    width: 250px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    z-index: 10020 !important;
    /* Higher than ANY highlight level (10003) */
    animation: bounceIn 0.5s ease;
}

.tour-tooltip p {
    margin: 0 0 15px;
    line-height: 1.5;
    color: #333;
    font-size: 0.95em;
}

.tour-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

.tour-skip-btn {
    background: none;
    border: none;
    color: #888;
    cursor: pointer;
    font-size: 0.9em;
    text-decoration: underline;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 0.9em;
    width: auto;
    display: inline-block;
}

/* Tooltip Arrows */
.tour-arrow {
    position: absolute;
    width: 0;
    height: 0;
    border-style: solid;
}

.tour-arrow.arrow-down-left {
    bottom: -10px;
    left: 20px;
    border-width: 10px 10px 0 10px;
    border-color: white transparent transparent transparent;
}

.tour-arrow.arrow-right-bottom {
    bottom: 20px;
    right: -10px;
    border-width: 10px 0 10px 10px;
    border-color: transparent transparent transparent white;
}

.tour-arrow.arrow-left-bottom {
    bottom: 20px;
    left: -10px;
    border-width: 10px 10px 10px 0;
    border-color: transparent white transparent transparent;
}

/* Highlight Classes */
.tour-highlight-fab {
    z-index: 10002 !important;
    /* Higher than sidebar */
    position: fixed !important;
    background-color: var(--primary-color);
    box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.5);
}

.tour-highlight-sidebar {
    /* If we strictly need to highlight navigation only, we should target it via JS or separate CSS class if possible.
       But for now, sticking to sidebar but fixing z-order issues. */
    z-index: 10001 !important;
    /* Above overlay (9998) */
    position: relative;
    /* Ensure z-index works */
    border-right: 2px solid var(--primary-color) !important;
    /* Visual cue */
}

/* Specific highlight for elements inside sidebar (like account button) */
.tour-highlight-element {
    position: relative;
    z-index: 10003 !important;
    background-color: white;
    /* Ensure opaque */
    box-shadow: 0 0 0 4px var(--priority-important), 0 0 15px rgba(0, 0, 0, 0.5);
    /* Yellow glow */
    border-radius: 8px;
    pointer-events: auto;
}

@keyframes bounceIn {
    0% {
        transform: scale(0.8);
        opacity: 0;
    }

    60% {
        transform: scale(1.05);
        opacity: 1;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Ensure Pomodoro button doesn't pop out when sidebar is highlighted, unless intended */
.tour-highlight-sidebar #pomodoro-widget,
.tour-highlight-sidebar #pomodoro-toggle-btn {
    box-shadow: none !important;
    /* Flatten it so it doesn't look 'lifted' independently */
}